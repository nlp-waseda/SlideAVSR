utt_0000 utt 0.29 14.06 -X HI EVERYONE! WELCOME TO THIS PRESENTATION ABOUT CONTEXTUAL BERT: CONDITIONING THE LANGUAGE MODEL USING A GLOBAL STATE. MY NAME IS TIMO DENK AND THIS IS JOINT WORK WITH AN ANA PELETEIRO THAT WAS CARRIED OUT AT ZALANDO IN BERLIN.
utt_0003 utt 14.06 25.87 -X ZALANDO IS AN ONLINE STORE FOR FASHION, WHICH HAS MORE THAN thirty MILLION ACTIVE CUSTOMERS IN THE EUROPEAN UNION. AND ONE OF THE THINGS CUSTOMERS MIGHT SEE WHEN THEY COME TO OUR WEB PAGE IS OUTFITS. ON THE LEFT-HAND SIDE YOU CAN SEE ONE OF
utt_0006 utt 25.87 30.00 -X THESE OUTFITS CONSISTING OF DIFFERENT ARTICLES FROM THE FASHION STORE.
utt_0007 utt 31.21 35.92 -X A PROBLEM THAT WE FACE IN REALITY IS THAT FASHION ITEMS GO OUT OF STOCK SOMETIMES.
utt_0008 utt 36.17 43.76 -X AND BECAUSE WE DON'T WANT TO DISCARD THE OUTFIT ALTOGETHER, WHEN ONE OF THE ITEMS GOES OUT OF STOCK, WE HAVE THE PROBLEM THAT WE WANT TO FIND A REPLACEMENT.
utt_0010 utt 44.30 54.45 -X THE REPLACEMENT SHOULDN'T – IN THAT CASE YOU SEE THE SHOE IS OUT OF STOCK – THE REPLACEMENT SHOULDN'T JUST BE ANY BLACK SHOE, BUT SHOULD BE A SHOE THAT'S ACTUALLY FITTING WITH THE REMAINING ARTICLES IN THE OUTFIT,
utt_0013 utt 55.18 56.21 -X STYLE WISE.
utt_0014 utt 58.13 63.64 -X A WAY TO MODEL THIS PROBLEM IS TO USE A LANGUAGE MODEL. YOU CAN SEE THE
utt_0015 utt 64.21 79.09 -X VISUALIZATION SHOWS A BERT MODEL IN WHICH THE OUTFIT IS BEING FED AT THE BOTTOM, AND ONE OF THE ARTICLES IS MASKED OUT, THE SHOES IN THAT CASE, THE ONES THAT ARE OUT OF STOCK, AND THE MODEL'S TASK IS TO PREDICT THE DISTRIBUTION
utt_0018 utt 79.09 86.17 -X OVER ALL ARTICLES AND MAKE A PREDICTION FOR WHICH ARTICLES FITTING AS A REPLACEMENT IN THAT OUTFIT.
utt_0020 utt 86.42 98.71 -X IF YOU TRAIN THE MODEL ON EXISTING OUTFIT DATA OVER TIME, WE'VE SEEN LIKE IT'S ABLE TO LEARN THE FASHION LANGUAGE KIND OF, SO ITS ABLE TO LEARN WHICH ARTICLES GO WELL WITH EACH OTHER AND CAPTURES THIS DISTRIBUTION OF STYLE.
utt_0023 utt 99.99 104.63 -X IT'S VERY SIMILAR TO NLP. IN NLP YOU HAVE A VOCABULARY OVER ALL WORDS OR WORD PIECES,
utt_0024 utt 104.88 112.57 -X AND IN THAT CASE, WE JUST HAVE A DISTRIBUTION OVER ALL ARTICLES THAT ARE IN STOCK.
utt_0026 utt 114.00 122.78 -X THERE'S A LITTLE PECULIARITY TO FASHION OUTFITS, WHICH IS THAT THEY DON'T HAVE AN ORDERING. THEY CAN BE SEEN AS SETS. AND SINCE THE ONLY WAY
utt_0028 utt 123.57 133.18 -X INFORMATION ABOUT THE ORDER OF THE INPUT IS INJECTED IN THE TRANSFORMER-BASED MODELS (INCLUDING BERT) IS THE POSITION ENCODING, WE JUST ACCOUNT FOR THAT BY REMOVING THE POSITIONAL ENCODING ALTOGETHER.
utt_0031 utt 133.27 136.73 -X SO THE OUTFIT IS BEING TREATED AS A SET.
utt_0032 utt 137.01 150.74 -X TO RECAP THAT REAL QUICK: THE PREDICTION THE MODEL IS MAKING IS THE PROBABILITY DISTRIBUTION OVER ALL ARTICLES THAT WE HAVE IN STOCK, CONDITIONED ON THE ARTICLES THAT ARE IN THE OUTFIT AND NOT MASKED-OUT. IN THIS CASE THE TWO ARTICLES,
utt_0035 utt 150.74 154.17 -X THE ONE TO THE LEFT AND THE ONE TO THE RIGHT OF THE MASKED-OUT ITEM.
utt_0036 utt 155.83 165.75 -X YOU CAN PROBABLY IMAGINE THAT FASHION IS QUITE AMBIGUOUS AND THERE IS OFTEN A NUMBER OF POSSIBLE REPLACEMENTS THAT ONE COULD PLUG INTO AN OUTFIT.
utt_0038 utt 165.75 178.27 -X HERE'S AN EXAMPLE: THREE DIFFERENT SHOES THAT COULD PROBABLY FIT INTO THIS OUTFIT, AND THIS AMBIGUITY IS SOMETHING THAT'S INHERENT TO FASHION, BUT WE WOULD LIKE TO MAKE THE PREDICTIONS PERSONALIZED SO THAT WE PICK THE
utt_0041 utt 178.27 181.24 -X ELEGANT SHOES, IF WE HAVE A CUSTOMER WHO PREFERS TO BUY THESE TYPES OF SHOES,
utt_0042 utt 181.24 186.43 -X MAYBE WE CAN INFER FROM THEIR PURCHASE HISTORY OR PICK THE URBAN SHOES FOR CUSTOMERS THAT HAVE THAT PARTICULAR STYLE.
utt_0044 utt 187.45 199.93 -X SO THE PREDICTION THAT WE WOULD LIKE TO MAKE IS, INSTEAD OF SAYING WE ONLY CONDITION THE DISTRIBUTION OVER ALL FASHION ARTICLES, THAT ARE THE OUTPUT OF THE MODEL FOR THE MASK POSITION, CONDITION IT ONLY ON THE OTHER ARTICLES
utt_0047 utt 199.93 208.16 -X IN THE OUTFIT, WE SAY WE CONDITION IT ON THE OTHER ARTICLES IN THE OUTFIT AND ADDITIONALLY THE CUSTOMER AND THE INFORMATION WE HAVE ABOUT THE CUSTOMER.
utt_0049 utt 209.69 220.03 -X A STRAIGHTFORWARD WAY OF ADOPTING THE PREVIOUS METHOD WITH THE BERT MODEL TO THAT NEW REQUIREMENT IS TO SAY WE ADD A NEW POSITION TO THE INPUT SEQUENCE.
utt_0051 utt 220.63 227.87 -X THE INPUT SEQUENCE WOULD THEN BE EXTENDED BY THIS CUSTOMER EMBEDDING, YOU CAN SEE IN THE BOTTOM-LEFT, WHICH CONTAINS A LOT OF CUSTOMER FEATURES.
utt_0053 utt 227.87 230.75 -X IT'S JUST A VECTOR CONSTRUCTED FROM CUSTOMER FEATURES.
utt_0054 utt 230.87 240.70 -X AND NOW THE MODEL HAS THIS POSSIBILITY TO ALSO ATTEND TO THAT POSITION AND MAKE ITS PREDICTION BASED ON THAT POSITION AND THE OTHER ITEMS IN THE OUTFIT.
utt_0056 utt 240.70 249.50 -X THERE'S ONE PROBLEM WITH THIS METHOD, WHICH IS, THAT THE FIRST-LEVEL MULTI-HEAD ATTENTION, OR IN GENERAL, THE MULTI-HEAD ATTENTION IN THE MODEL, THAT IS
utt_0058 utt 250.04 264.64 -X THE MAIN ELEMENT FOR INFORMATION FLOW BETWEEN THE DIFFERENT POSITIONS, IS UNAWARE OF THE FACT THAT THE CUSTOMER EMBEDDING IS A DIFFERENT MODALITY AND HAS A DIFFERENT SEMANTIC MEANING, IN THIS ENTIRE CONTEXT, THAN THE OTHER ITEMS IN THE OUTFIT.
utt_0062 utt 265.18 272.43 -X THIS MEANS IT USES THE SAME WEIGHTS TO ATTEND TO THE CUSTOMER EMBEDDING AS IT ATTENDS TO THE OTHER ITEMS IN THE OUTFIT. AND THAT'S SUB-OPTIMAL, THERE'S NO
utt_0064 utt 272.57 281.50 -X ARCHITECTURAL INDUCTIVE BIAS THAT TELLS THE MODEL: ALRIGHT, THIS IS THE CUSTOMER CONTEXT, YOU CAN USE IT FOR ONE THING, FOR MAKING PERSONALIZED
utt_0067 utt 284.50 287.07 -X STYLE-WISE COHERENT PREDICTION.
utt_0068 utt 287.10 297.33 -X AND THIS PROBLEM IS EXACTLY WHAT WE'RE TRYING TO SOLVE BY INTRODUCING A GLOBAL STATE. YOU CAN SEE HERE A SIMILAR VISUALIZATION, BUT IT'S
utt_0070 utt 297.33 306.27 -X APPARENT THAT THE CUSTOMER EMBEDDING IS NOW KIND OF IN THIS SEPARATE BOX, WHICH IS LABELED AS THE GLOBAL STATE. AND THE WAY THE
utt_0072 utt 307.97 318.48 -X TRANSFORMER BLOCKS, WHICH THE BERT MODEL IS COMPOSED OF, COMPUTE THEIR INTERNAL REPRESENTATIONS IS NOW BY ALSO ACCESSING THE GLOBAL STATE, INDICATED BY
utt_0074 utt 318.48 330.53 -X THE DARK, BLACK ARROWS. AND THE PREVIOUS NORMAL ATTENTION THAT BERT HAS ARE THE GRAY ARROWS. THIS IS INSPIRED BY THE GRAPH NETWORK'S PERSPECTIVE, BECAUSE IT HAS BEEN SHOWN THAT BERT AND THE TRANSFORMER-BASED MODELS CAN BE SEEN AS
utt_0077 utt 330.53 342.68 -X GRAPH NETWORKS AND WITHIN THE GRAPH NETWORKS FRAMEWORK THEY'RE LACKING THAT GLOBAL STATE. SO THIS WAS KIND OF WHAT GAVE US THAT IDEA OF ADDING A GLOBAL STATE AND THEN USING IT FOR CONDITIONING. SO THE PRODUCTION IS
utt_0080 utt 342.68 356.07 -X STILL PERSONALIZED, AS IN PREVIOUS EXAMPLE, BUT NOW THE DIFFERENCE IS THAT WE HAVE SEPARATE ATTENTION FOR READING FROM THE GLOBAL STATE AND FOR DOING THAT INTRA-SEQUENCE ATTENTION THAT THE, YEAH, THE MODEL IS NORMALLY DOING ANYWAY.
utt_0083 utt 361.28 373.57 -X SO WE PRESENT IN THE PAPER TWO DIFFERENT WAYS OF IMPLEMENTING THAT GLOBAL STATE METHOD. THE EXACT MATHEMATICAL SPECIFICS OF IT, I LEAVE TO THE AUDIENCE TO READ IN THE PAPER. YEAH.
utt_0086 utt 375.49 379.69 -X NEXT, I'LL JUMP TO THE EMPIRICAL EVALUATION THAT WE HAVE DONE ON AN
utt_0087 utt 379.94 384.04 -X OUTFITS DATA SET, AND HERE ARE SOME CHARACTERISTICS OF THE DATA SET: IT
utt_0088 utt 385.12 389.70 -X CONSISTS OF three hundred and eighty,zero OUTFITS THAT THEMSELVES ARE COMPOSED OF thirty-one,zero
utt_0089 utt 390.08 394.63 -X DIFFERENT ARTICLES AND THE AVERAGE OUTFIT LENGTH IS FIVE.
utt_0090 utt 395.91 405.64 -X EACH OF THE SAMPLES IS FROM A SPECIFIC CUSTOMER WHO FILLED OUT A QUESTIONNAIRE ABOUT THEIR STYLE PREFERENCES, I'M GOING TO READ THEM OUT QUICKLY: AGE, GENDER,
utt_0092 utt 405.64 409.96 -X COUNTRY, PREFERRED BRANDS, COLORS, STYLES, NOGO TYPES, CLOTHING SIZES,
utt_0093 utt 410.24 425.11 -X PRICING PREFERENCES, AND ACTUALLY A NUMBER OF OTHER FEATURES. AND THESE FEATURES WERE GIVEN TO A PROFESSIONAL STYLIST WHO THEN IN TURN CREATED OR ASSEMBLED AN OUTFIT OF ZALANDO ARTICLES THAT WAS PHYSICALLY SHIPPED TO THAT
utt_0096 utt 425.11 436.87 -X SPECIFIC CUSTOMER. SO THERE IS A STRONG STATISTICAL DEPENDENCE BETWEEN THE OUTFIT THAT WAS CREATED, BECAUSE THE STYLIST CREATED THE OUTFIT FOR THAT SPECIFIC CUSTOMER BASED ON THE QUESTIONNAIRE, BASED ON THE INFORMATION
utt_0099 utt 436.87 441.07 -X THAT THE CUSTOMER PROVIDED. NOW EACH OF THESE SAMPLES WE CAN TAKE
utt_0100 utt 441.67 455.43 -X THE OUTFIT, REMOVE ONE OF THE ARTICLES FROM THE OUTFIT AND THEN LET THE MODEL MAKE THE PREDICTION FOR WHAT ARTICLE TO PUT THERE, BASED ON THE REST OF THE OUTFIT AND ADDITIONALLY THE CUSTOMER CONTEXT, THE QUESTIONNAIRE INFORMATION THAT WE EMBED INTO A CUSTOMER VECTOR.
utt_0104 utt 457.54 461.23 -X THE RESULTS OF THAT EVALUATION YOU CAN SEE IN THIS TABLE.
utt_0105 utt 462.25 465.92 -X FIRST, YEAH, THE DIFFERENT ROWS ARE COMPARING THE DIFFERENT METHODS OF
utt_0106 utt 466.12 470.48 -X ADDING CONTEXT. THE FIRST ONE IS THE BASELINE, JUST NO CONTEXT AT ALL.
utt_0107 utt 470.48 483.05 -X THIS KIND OF A TRIVIAL BASELINE. THEN BY CONCATENATING THE CONTEXT VECTOR WITH EVERY INPUT, THEN THE NEW POSITION, THIS IS THE ONE I VISUALLY SHOWED BEFORE, WHERE WE JUST EXTENDED THE SEQUENCE BY ADDING A NEW POSITION, AND
utt_0110 utt 484.68 488.49 -X THEN THE TWO GLOBAL STATE METHODS THAT WE INTRODUCED.
utt_0111 utt 490.28 493.74 -X BY ADDING PERSONALIZATION YOU SEE A RELATIVE IMPROVEMENT OF forty-three% OVER NO
utt_0112 utt 494.54 499.21 -X PERSONALIZATION AND BY ADDING A GLOBAL STATE WE SEE A sixteen% RELATIVE
utt_0113 utt 499.66 500.72 -X IMPROVEMENT.
utt_0114 utt 502.79 516.40 -X NOW THE NUMBER OF PARAMETERS ALSO INCREASES, SO IN REALITY WHEN ONE WANTS TO USE THIS IN A BUSINESS CONTEXT THIS TRADEOFF NEEDS TO BE MADE: HOW MUCH WORTH THE INCREASE IN PARAMETERS IS, GIVEN THE IMPROVEMENT IN RECALL. YEAH,
utt_0117 utt 516.40 527.37 -X RECALL IS ALWAYS LIKE HOW OFTEN THE MODEL MANAGES TO PREDICT THE RIGHT ITEM AT THE RANK ONE OR AMONG THE FIRST two hundred and fifty RANKS, IN THE THIRD COLUMN.
utt_0119 utt 527.37 538.35 -X THE BERT MODEL ITSELF CAN PROCESS GRAPHS OUT OF THE BOX. WHAT WE DID IS DO AN ARCHITECTURAL MODIFICATION OF THE BERT MODEL THAT ALLOWS IT TO
utt_0121 utt 538.35 552.90 -X PROCESS THE NODES IN A GRAPH AND ADDITIONALLY TAKE A GLOBAL CONTEXT (A GLOBAL STATE) INTO ACCOUNT, WHICH IS ALSO SHOWN IN THE FIGURE ON THE LEFT-HAND SIDE OF THE SLIDE. WE HAVE EMPIRICALLY VALIDATED THIS METHOD ON
utt_0124 utt 552.90 558.61 -X OUR PROPRIETARY DATA SET, WHERE WE MAKE PERSONALIZED ARTICLE REPLACEMENTS.
utt_0125 utt 559.02 567.22 -X IN THAT CASE, THE NODES IN THE GRAPH ARE THE ARTICLES IN AN OUTFIT AND THE GLOBAL STATE IS CUSTOMER INFORMATION.
utt_0127 utt 567.28 579.28 -X YEAH, WE BELIEVE THIS CONTRIBUTION ENABLES ALSO NLP USE CASES IN WHICH CASE THE GRAPH JUST CONSISTS OF SENTENCES OF WORDS, AND THE CONTEXT COULD BE SOMETHING LIKE THE CREATION TIME OF THAT TEXT OR THE SENTIMENT.
utt_0130 utt 579.44 590.80 -X YOU COULD CONSIDER, LIKE A SPELLING CORRECTION THAT IS CONDITIONED ON THE DOMAIN IN WHICH THE TEXT WAS WRITTEN, FOR EXAMPLE, LAWYERS THEY MIGHT USE DIFFERENT ACRONYMS AND COMPUTER SCIENTISTS. SO YOU HAVE LIKE THIS
utt_0133 utt 591.47 595.57 -X CONTEXT-DEPENDENT SPELLING CORRECTION AS ONE POTENTIAL USE CASE.
utt_0134 utt 595.57 605.01 -X WITH THAT, I WOULD LIKE TO THANK YOU FOR YOUR ATTENTION. AND I'M LOOKING FORWARD TO SEEING ALL THE OTHER CONTRIBUTIONS AT THE WORKSHOP AND DISCUSSING THEM IN THE POSTER SESSION. THANK YOU!
